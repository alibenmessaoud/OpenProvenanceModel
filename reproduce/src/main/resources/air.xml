<program xmlns="http://ci.uchicago.edu/swift/2009/02/swiftscript"
         xmlns:opr="http://openprovenance.org/reproducibility"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns:xs="http://www.w3.org/2001/XMLSchema">

<!-- taken from swift2/cog/modules/swift/tests/language/working-baseq13.xml -->
  
  <types>
     	<type>
     		<typename>WarpParameters</typename>
     		<typealias>string</typealias>
     		<typestructure></typestructure>
     	</type>
     	<type>
     		<typename>PGM</typename>
     		<typealias>string</typealias>
     		<typestructure></typestructure>
     	</type>
     	<type>
     		<typename>IMG</typename>
     		<typealias>string</typealias>
     		<typestructure></typestructure>
     	</type>
     	<type>
     		<typename>HDR</typename>
     		<typealias>string</typealias>
     		<typestructure></typestructure>
     	</type>
     	<type>
     		<typename>JPG</typename>
     		<typealias>string</typealias>
     		<typestructure></typestructure>
     	</type>
     	<type>
     		<typename>AnatomyImage</typename>
     		<typealias>string</typealias>
     		<typestructure></typestructure>
     	</type>
     	<type>
     		<typename>AnatomyHeader</typename>
     		<typealias>string</typealias>
     		<typestructure></typestructure>
     	</type>
     	<type>
     		<typename>AtlasHdr</typename>
     		<typealias>string</typealias>
     		<typestructure></typestructure>
     	</type>
     	<type>
     		<typename>AtlasImg</typename>
     		<typealias>string</typealias>
     		<typestructure></typestructure>
     	</type>
     	<type>
     		<typename>ReferenceImage</typename>
     		<typealias>string</typealias>
     		<typestructure></typestructure>
     	</type>
     	<type>
     		<typename>ReferenceHeader</typename>
     		<typealias>string</typealias>
     		<typestructure></typestructure>
     	</type>
     	<type>
     		<typename>Resliced_IMG</typename>
     		<typealias>string</typealias>
     		<typestructure></typestructure>
     	</type>
     	<type>
     		<typename>Resliced_HDR</typename>
     		<typealias>string</typealias>
     		<typestructure></typestructure>
     	</type>
     	<type>
     		<typename>Resliced</typename>
     		<typealias>string</typealias>
     		<typestructure></typestructure>
     	</type>
  </types>  


  <procedure name="align_warp" src="line 4">

      <output name="o" type="WarpParameters"    xsi:nil="true" opr:role="out"/>

      <input  name="i1" type="AnatomyImage"     xsi:nil="true" opr:role="img"/>
      <input  name="i2" type="ReferenceImage"   xsi:nil="true" opr:role="imgRef"/>
      <input  name="i3" type="AnatomyImage"     xsi:nil="true" opr:role="hdr"/>
      <input  name="i4" type="ReferenceImage"   xsi:nil="true" opr:role="hdrRef"/>

      <binding>
        <application src="line 5">
          <executable>align_warp</executable>
          <function name="filename"><variableReference>i1</variableReference></function>
          <function name="filename"><variableReference>i2</variableReference></function>
          <function name="filename"><variableReference>o</variableReference></function>
          <stringConstant>-m</stringConstant>
          <stringConstant>12</stringConstant>
          <stringConstant>-q</stringConstant>
        </application>
      </binding>
  </procedure>




  <procedure name="reslice" src="line 4">
      <output name="o1"  type="Resliced_IMG"   xsi:nil="true" opr:role="img"/>
      <output name="o2"  type="Resliced_HDR"   xsi:nil="true" opr:role="hdr"/>
      <input  name="i1" type="WarpParameters"     xsi:nil="true" opr:role="in"/>

      <binding>
        <application src="line 5">
          <executable>reslice</executable>
          <function name="filename"><variableReference>i1</variableReference></function>
          <function name="filename"><variableReference>o1</variableReference></function>
        </application>
      </binding>
  </procedure>


  <procedure name="softmean2" src="line 4">
      <output name="o1"  type="AtlasImg"   xsi:nil="true" opr:role="img"/>
      <output name="o2"  type="AtlasHdr"   xsi:nil="true" opr:role="hdr"/>
      <input  name="in1"  type="Resliced"   xsi:nil="true" opr:role="i1"/>
      <input  name="hdr1"  type="Resliced"   xsi:nil="true" opr:role="h1"/>

      <binding>
        <application src="line 5">
          <executable>softmean</executable>
          <function name="filename"><variableReference>o2</variableReference></function>
          <stringConstant>y</stringConstant>
          <stringConstant>null</stringConstant>
          <function name="filename"><variableReference>in1</variableReference></function>
        </application>
      </binding>
  </procedure>

  <procedure name="softmean" src="line 4">
      <output name="o1"  type="AtlasImg"   xsi:nil="true" opr:role="img"/>
      <output name="o2"  type="AtlasHdr"   xsi:nil="true" opr:role="hdr"/>
      <input  name="in1"  type="Resliced"   xsi:nil="true" opr:role="i1"/>
      <input  name="hdr1"  type="Resliced"   xsi:nil="true" opr:role="h1"/>
      <input  name="in2"  type="Resliced"   xsi:nil="true" opr:role="i2"/>
      <input  name="hdr2"  type="Resliced"   xsi:nil="true" opr:role="h2"/>
      <input  name="in3"  type="Resliced"   xsi:nil="true" opr:role="i3"/>
      <input  name="hdr3"  type="Resliced"   xsi:nil="true" opr:role="h3"/>
      <input  name="in4"  type="Resliced"   xsi:nil="true" opr:role="i4"/>
      <input  name="hdr4"  type="Resliced"   xsi:nil="true" opr:role="h4"/>

      <binding>
        <application src="line 5">
          <executable>softmean</executable>
          <function name="filename"><variableReference>o2</variableReference></function>
          <stringConstant>y</stringConstant>
          <stringConstant>null</stringConstant>
          <function name="filename"><variableReference>in1</variableReference></function>
          <function name="filename"><variableReference>in2</variableReference></function>
          <function name="filename"><variableReference>in3</variableReference></function>
          <function name="filename"><variableReference>in4</variableReference></function>
        </application>
      </binding>
  </procedure>


  <procedure name="slicer" src="line 10">
      <output name="o"  type="PGM"     xsi:nil="true" opr:role="out"/>
      <input  name="i1" type="IMG"     xsi:nil="true" opr:role="img"/>
      <input  name="i2" type="HDR"     xsi:nil="true" opr:role="hdr"/>
      <input  name="p"  type="string"  xsi:nil="true" opr:role="param"/>

      <binding>
        <application src="line 5">
          <executable>slicer</executable>
          <function name="filename"><variableReference>i2</variableReference></function>
          <variableReference>p</variableReference>
          <!-- <stringConstant>-x .5</stringConstant> -->
          <function name="filename"><variableReference>o</variableReference></function>
        </application>
      </binding>
  </procedure>

  <procedure name="convert" src="line 12">
      <output name="o"  type="JPG"     xsi:nil="true" opr:role="out"/>
      <input  name="i"  type="PGM"     xsi:nil="true" opr:role="in"/>

      <binding>
        <application src="line 5">
          <executable>convert</executable>
          <function name="filename"><variableReference>i</variableReference></function>
          <function name="filename"><variableReference>o</variableReference></function>
        </application>
      </binding>
  </procedure>



  <!-- invocation code -->

  <variable name="outfile" type="messagefile" isGlobal="false"><file name="q13greeting.txt"/></variable>
  <variable name="c" type="countfile" isGlobal="false"><file name="count.txt"/></variable>
  <call proc="greeting" src="line 19">
    <output><variableReference>outfile</variableReference></output>
    <input><stringConstant>hello from Swift</stringConstant></input>
  </call>
  <call proc="countwords" src="line 20">
    <output><variableReference>c</variableReference></output>
    <input><variableReference>outfile</variableReference></input>
  </call>
</program>
